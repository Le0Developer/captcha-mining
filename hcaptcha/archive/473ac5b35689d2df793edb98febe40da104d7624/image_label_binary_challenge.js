/* https://hcaptcha.com/license */
var image_label_binary=function(t,e,i,s,n,o,r){"use strict";o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o["default"]:o,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r["default"]:r;var a=new n.Theme;a.add("contrast",{component:{prompt:{main:{fill:"#fff",text:"#000"}},expandButton:{main:{fill:"#000"}}}}),a.add("grey-red",{component:{prompt:{main:{fill:"#6a6a6a"}},task:{main:{fill:"#fff"},selected:{border:"#FF0000"}},expandButton:{main:{fill:"#6a6a6a"}}}});var h=[],l=[],c=0,d=Object.create(null),p=Object.create(null),u=function(t,e){d=Object.create(null),h=[],c=0,l=t;for(var i=[],s=0,n=0;n<t.length;n++)s+=1,i.push(t[n]),s%e!=0&&s!==t.length||(h.push(i),i=[])},m=function(){return h.length},g=function(){return h[0].length},f=function(){return c},y=function(){var t=h[c];return c+=1,t},b=function(t){for(var e in t)d[e]=t[e]},v=function(){return d},k=function(){return c===h.length},w=function(){for(var t=l.length,e=0;e<t;e++){var i=l[e].task_key;if(!d[i])return!1}return!0},_=function(){if(!l||0===l.length)return!1;for(var t=l.length,e=0;e<t;e++){var i=l[e].task_key;if("true"===d[i])return!0}return!1},x=function(){p=Object.create(null);for(var t=null,i=0;i<l.length;i++)t=l[i],p[t.task_key]=e.Loader.image(t.datapoint_uri)["catch"]((function(){}))},E=function(t){return p[t]};function C(t,e){var i={center:!0};return t.width/t.height===16/9&&!1!==e?i.cover=!0:i.contain=!0,i}function L(t){e.Extend.self(this,e.DomComponent,"task-image"),t||(t={}),this._style=t.theme,this._crop=t.crop||!1,this._image=null,this.state={size:null,mobile:!0,focused:!1,selected:!1,report:!1,scale:1},this.$wrapper=this.createElement(".wrapper"),this.$image=this.$wrapper.createElement(".image"),this.badge=this.initComponent(i.Badge,{icon:{src:"data:image/svg+xml,%3csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cg clip-path='url(%23clip0_1354_4547)'%3e%3cpath d='M11.1111 6L6.83333 10.2778L4.88889 8.33333' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath id='clip0_1354_4547'%3e%3crect width='9.33333' height='9.33333' fill='white' transform='translate(3.33334 3.66699)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",fallback:"https://newassets.hcaptcha.com/captcha/v1/473ac5b35689d2df793edb98febe40da104d7624/challenge/image_label_binary/static/images/icon-check.png"},theme:a},this.$wrapper),this.badge.display(!1),this.badge.fill(this._style.selected.badge)}function R(t){e.Extend.self(this,e.DomComponent,".task-border"),t||(t={}),this._style=t.theme,this.outline=this.initComponent(i.Border,{thickness:2,rounded:2}),this.inset=this.initComponent(i.Border,{thickness:6,rounded:2})}function A(t){e.Extend.self(this,e.DomComponent,".task");var s=this;this.key=null,this.state={report:!1,empty:!0,active:!1,focused:!1,locked:!1,index:t.index},this.timer=null;var r=function(t){var e=t.palette,i=t.component;return n.Theme.merge({main:{fill:e.grey[200],badge:"none",outline:"none"},selected:{fill:e.grey[200],badge:e.primary.main},report:{fill:e.grey[200],badge:e.warn.main,outline:e.warn.main},focus:{fill:e.grey[200],outline:e.primary.main}},i.task)}(a.get());this.setAttribute("tabindex","-1"),this.setAttribute("role","button"),this.setAttribute("aria-label",o.translate("Challenge Image {{id}}",{id:t.index+1})),this.setAttribute("aria-pressed",!1),this.loader=this.initComponent(i.LoadingIndicator,null),this.image=this.initComponent(L,{theme:r}),this.border=this.initComponent(R,{theme:r}),this.loader.display(!1),this.setStyle=this.setStyle.bind(this),this.onDestroy=function(){s.timer&&(s.timer=clearTimeout(s.timer))}}e.Extend.proto(L,e.DomComponent),L.prototype.style=function(t,e){this.state.size=t,this.state.mobile=e,this.state.scale=e?.8:.84;var i=this.state.selected?this.state.scale:1,s=this.state.size*i;if(this.css({width:t,height:t,position:"absolute"}),this.$wrapper.css({width:s,height:s,overflow:"hidden",borderRadius:2,transition:"none",position:"relative",top:"50%",left:"50%",marginTop:-s/2,marginLeft:-s/2}),this.$image.css({"-ms-high-contrast-adjust":"none",position:"absolute",top:0,left:0,zIndex:5,transition:"none"}),this.badge.size(16),this.badge.css({position:"absolute",top:e?3:5,right:e?3:5,zIndex:10}),null!==this._image){var n=C(this._image,this._crop);this.$image.backgroundImage(this._image,s,s,n)}},L.prototype.isReady=function(){return!!this._image},L.prototype.display=function(t){this.css({opacity:t,transition:"none"})},L.prototype.setImage=function(t){if(null!==this.dom&&t){this._image=t;var e=C(t,this._crop);this.$image.backgroundImage(this._image,this.size,this.size,e)}},L.prototype.reset=function(){this.state.selected=!1,this.badge.reset();var t=this._size;if(this.$wrapper.css({marginTop:-t/2,marginLeft:-t/2,width:t,height:t,transition:"none"}),null!==this._image){var e=C(this._image,this._crop);this.$image.backgroundImage(this._image,t,t,e)}},L.prototype.select=function(t){if(null!==this.dom&&null!==this._image){this.badge.display(t,!0),this.state.selected=t;var e=this.state.selected?this.state.scale:1,i=this.state.size*e,s="android"===r.System.os&&(window.navigator.userAgent.indexOf("wv")>0||window.navigator.userAgent.indexOf("webview")>0)?"none":"all 0.1s cubic-bezier(.05,.55,.5,.99)";this.$wrapper.css({marginTop:-i/2,marginLeft:-i/2,width:i,height:i,transition:s});var n=C(this._image,this._crop);this.$image.backgroundImage(this._image,i,i,n),this.$image.css({transition:s})}},L.prototype.setStyle=function(t){var e=this._style[t],i=e.badge,s=e.fill;"none"===e.badge?this.badge.reset():(e.badge||(i=this._style.selected),this.badge.fill(i)),s||(s=this._style.main.fill),this.$wrapper.css({backgroundColor:s})},e.Extend.proto(R,e.DomComponent),R.prototype.style=function(t){this.size=t,this.css({width:t,height:t,position:"relative"}),this.outline.style(t),this.inset.style(t),this.outline.css({position:"absolute",top:0,left:0,zIndex:5}),this.inset.css({position:"absolute",top:0,left:0,zIndex:0}),this.inset.setColor(a.get().palette.common.white)},R.prototype.display=function(t){this.outline.setVisibility(t),this.inset.setVisibility(t)},R.prototype.reset=function(){this.outline.setVisibility(!1),this.inset.setVisibility(!1)},R.prototype.setStyle=function(t){var e=this._style[t],i=e.border||e.outline;i&&"none"!==i||(i=(e=this._style.focus).border||e.outline),this.outline.setColor(i)},e.Extend.proto(A,e.DomComponent),A.prototype.getIndex=function(){return this.state.index},A.prototype.style=function(t,e){this.size=t,this.loader.style(e),this.loader.css({zIndex:1}),this.css({width:t,height:t,cursor:this.state.locked?"pointer":"default",boxSizing:"border-box",outline:"none",border:"none"}),this.border.style(t),this.border.css({position:"absolute",zIndex:10,top:0,left:0}),this.image.style(t,e)},A.prototype.load=function(t){var e=this;return this.state.empty=!1,this.key=t,this.timer=setTimeout((function(){e.loader.display(!0)}),250),E(this.key).then((function(t){return e.timer&&(clearTimeout(e.timer),e.timer=null),e.loader.display(!1),e.image.setStyle("main"),e.image.setImage(t),t}))},A.prototype.display=function(t){t&&this._image||(this.state.active=!1,this.state.locked=!0),this.image.display(t),this.border.display(this.state.active),this.state.empty||this.setAttribute("tabindex",t?"0":"-1")},A.prototype.setReport=function(t){if(!this.state.empty){this.state.report=t,this.state.active=!1;var e=this.state.report?"report":"main";this.setStyle(e),this.image.reset(),this.border.reset(),t?this.removeAttribute("aria-pressed"):this.setAttribute("aria-pressed",!1)}},A.prototype.lock=function(t){t||this.image.isReady()||(t=!0),this.state.locked=t,this.css({cursor:t?"default":"pointer"})},A.prototype.select=function(t){if(!0===this.state.locked||this.state.empty)return!1;this.setAttribute("aria-pressed",t);var e=this.state.report?"report":"selected";return this.setStyle(t?e:"main"),this.image.select(t),this.state.active=t,!0},A.prototype.isActive=function(){return this.state.active},A.prototype.isFocused=function(){return this.state.focused},A.prototype.isEmpty=function(){return this.state.empty},A.prototype.canReport=function(){return this.state.report},A.prototype.setStyle=function(t){this.image.setStyle(t),this.border.setStyle(t)},A.prototype.setFocus=function(t){if(this.state.empty)return!1;this.state.focused=t;var e="main";this.state.active&&(e=t?"focus":"selected"),this.state.report&&(e="report"),this.setStyle(e),this.border.display(t)};function I(t){e.Extend.self(this,e.DomComponent,"task-grid"),this.state={index:-1,tabIndex:-1,keyboard:!1,orientation:t.config.orientation};for(var i,s=g(),n=[],o=0;o<s;o++)(i=this.initComponent(A,{index:o})).display(!1),i.addEventListener("click",S.bind(this,i)),i.addEventListener("enter",S.bind(this,i)),i.addEventListener("focus",z.bind(this,i)),i.addEventListener("blur",O.bind(this,i)),n.push(i);this.total=s,this.items=n,this.tasks=t.tasks,this.selected=[],this.columns="landscape"===this.state.orientation?5:s%3==0||3===s||s>4?3:2,this.rows=Math.ceil(s/this.columns),this.config={max_selections:t.config.max_selections||this.total},this.addEventListener("keydown",D.bind(this))}e.Extend.proto(I,e.DomComponent),I.prototype.style=function(t,e){for(var i="landscape"===this.state.orientation,s=(t-10*(this.columns-1))/this.columns,n=this.rows*s+10*(this.rows-1),o=0,r=0,a=0;a<this.items.length;a++)this.items[a].style(s,e),this.items[a].css({position:"absolute",left:o,top:r}),(o+=s+10)>=t&&(o=i?t/this.total:0,r+=s+10);return this.css({width:t,height:n,position:"relative",display:"inline-block"}),{width:t,height:n}},I.prototype.lock=function(t){for(var e=0;e<this.total;e++)this.items[e].lock(t)},I.prototype.load=function(){for(var t,e=[],i=null,s=0;s<this.tasks.length;s++)i=this.tasks[s],t=this.items[s].load(i.task_key),e.push(t);return Promise.all(e).then((function(t){for(var e=0,i=t.length,s=i;s--;)e+=t[s]?0:1;if(e/i>.1111111111111111)throw new Error("Missing task images")}))},I.prototype.display=function(t){for(var e=0;e<this.items.length;e++)this.items[e].display(t)},I.prototype.focus=function(t,e){var i=t||0,s=this.items[i];s&&(this.state.keyboard="keyboard"===e,this.state.tabIndex>-1&&s.focus(),document.activeElement&&"menu-info"===document.activeElement.id&&(this.state.tabIndex=this.items.length-1))},I.prototype.report=function(t){for(var e=0;e<this.items.length;e++)this.items[e].setReport(t)},I.prototype.getAnswers=function(){for(var t={},e=0;e<this.total;e++)this.items[e].isEmpty()||(t[this.items[e].key]=String(this.items[e].isActive()));return t};var S=function(t,e){var i=this.config.max_selections;if(!t.isEmpty()){if(t.canReport())return t.select(!0),void this.emit("report",t.key);if(!t.isActive()&&this.selected.length<i)this.selected.push(t),t.select(!0);else for(var s=this.selected.length;--s>-1;)this.selected[s]===t&&(this.selected.splice(s,1),t.select(!1));this.state.keyboard=!1,this.state.index=t.getIndex(),this.emit("select",this.selected.length>0)}},z=function(t){this.state.keyboard&&(t.setFocus(!0),this.state.keyboard=!1),this.state.index=t.getIndex(),this.state.tabIndex=this.state.index},O=function(t,e){t.setFocus(!1)},D=function(t){var e=t.keyNum,i=this.state.index,s=i;9===e?(this.state.keyboard=!0,t.shiftKey&&0===i&&F.call(this,t)):37===e?s--:39===e?s++:38===e?s-=3:40===e&&(s+=3),s<0||s>this.items.length-1?F.call(this,t):i!==s&&(this.state.keyboard=!0,this.items[s]&&this.items[s].focus())},F=function(t){this.items[this.state.index]&&this.items[this.state.index].blur(),this.emit("blur"),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()};function $(){e.Extend.self(this,e.DomComponent,"challenge-view"),this.width=0,this.height=0,this.top=0,this.mobile=!1,this.config={max_selections:null},this.header=this.initComponent(i.ChallengeHeader,{theme:a}),this.grid=null}e.Extend.proto($,e.DomComponent),$.prototype.style=function(t,e){var i=this.header.style(t,10,e).height;this.grid&&(i+=10+this.grid.style(t,e).height);this.css({width:t,height:i}),this.width=t,this.height=i,this.mobile=e},$.prototype.lock=function(t){this.grid&&this.grid.lock(t)},$.prototype.setup=function(t,e){var i=this,n=t.requester_question,o=t.requester_question_example,r=t.request_config||{};return this.config={max_selections:r.max_selections&&"number"==typeof Number(r.max_selections)?Number(r.max_selections):null,orientation:e.orientation,skipText:t.show_skip_text,requestConfig:r},this.grid&&(this.grid=this.grid.destroy()),this.header.load(n,o,this.config,s.ImgUtil).then((function(){i.header.setCopy()}))},$.prototype.loadTasks=function(t){var e=this,i=null;return this.grid&&(i=this.grid).display(!1),this.grid=this.initComponent(I,{tasks:t,config:this.config}),this.grid.on("select",(function(t){e.emit("select",t)})),this.grid.on("report",(function(t){e.emit("report",t)})),this.grid.on("blur",(function(){e.emit("blur")})),this.grid.load().then((function(){e.grid.dom&&(i&&(i=i.destroy()),e.grid.style(e.width,e.mobile),e.grid.display(!0),e.grid.lock(!1))}))},$.prototype.report=function(t){this.header.displayReport(t),this.grid&&this.grid.report(t)},$.prototype.translate=function(){this.header.setCopy()},$.prototype.focusGrid=function(t,e){this.grid&&(t=(t=t||0)<0?this.grid.items.length+t:t,this.grid.focus(t,e))};function T(t){e.Extend.self(this,e.DomComponent,"challenge");var i=this;this.type="image_label_binary",this.resolve=null,this.reject=null,this.breadcrumbs=0,this.served=0,this.orientation="portrait",this.state={interaction:"mouse"},t&&this.theme(t.theme.name,t.theme.config),this.syncCheckState=this.syncCheckState.bind(this),this.setFocus=this.setFocus.bind(this),this.view=this.initComponent($),this.view.on("select",this.syncCheckState),this.view.on("report",(function(t){i.view.lock(!0),i.emit("report-image",t)})),this.view.on("blur",(function(){i.emit("focus-check")}))}return e.Extend.proto(T,e.DomComponent),T.prototype.style=function(e,i){var s=this;this.mobile=e<=650;var n=this.mobile?300:380;return"landscape"===this.orientation&&(this.mobile=!0,n=415),new Promise((function(e,i){try{s.view.style(n,s.mobile),e({width:s.view.width,height:s.view.height,mobile:s.mobile}),s.css({width:s.view.width,height:s.view.height})}catch(o){i({event:t.CaptchaError.CHALLENGE_ERROR,message:"Failed to style",reason:o.message})}}))},T.prototype.theme=function(t,e){e?(a.add("custom",a.extend(a.active(),e)),a.use("custom")):a.use(t)},T.prototype.setup=function(e,i){var s=this,n=this.view;return new Promise((function(o,r){if(e.tasklist&&0!==e.tasklist.length){try{s.orientation=i||"portrait";n.lock(!1),n.report(!1),u(e.tasklist,9),x(),s.breadcrumbs=m(),s.served=f();var a=n.setup(e,{orientation:i}),h=y(),l=n.loadTasks(h);Promise.all([a,l]).then((function(){s.syncCheckState(),n.lock(!1),s.served=f()}))["catch"]((function(e){r({event:t.CaptchaError.CHALLENGE_ERROR,message:"Failed to setup task",reason:e})}))}catch(c){r(c.message)}s.resolve=o,s.reject=r}else r({event:t.CaptchaError.CHALLENGE_ERROR,message:"Missing tasklist"})}))},T.prototype.syncCheckState=function(){var t=_(),e=null!==this.view.grid&&0!==this.view.grid.selected.length;this.emit&&this.emit("display-check",e||t)},T.prototype.submit=function(){var e=this,i=this.view,s=this.resolve,n=this.reject;try{if(i.lock(!0),b(i.grid.getAnswers()),k())w()?s(v()):n({event:t.CaptchaError.CHALLENGE_ERROR,message:"Answers are incomplete"});else{var o=y();i.loadTasks(o).then((function(){e.served=f(),e.syncCheckState(),e.setFocus(0,e.state.interaction)}))["catch"]((function(e){n({event:t.CaptchaError.CHALLENGE_ERROR,message:"Failed to setup task",reason:e})}))}}catch(r){n({event:t.CaptchaError.CHALLENGE_ERROR,message:"Failed to setup task",reason:r.message})}},T.prototype.report=function(t){var e=this.view;e.lock(!1),e.report(t)},T.prototype.translate=function(){this.view.translate()},T.prototype.setFocus=function(t,e){this.state.interaction=e,this.view.focusGrid(t||0,e)},T}(_sharedLibs.packages.constants,_sharedLibs.packages.core,_sharedLibs.packages.ui,_sharedLibs.packages.utils,_sharedLibs.packages.theme,_sharedLibs.packages.language,_sharedLibs.packages.device);
